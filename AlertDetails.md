# Metric Alerts Details

The following metric alerts have been defined and can deployed within your landing zones via Azure Policy.

Placeholders have been added for future work which will define Alert Processing Rules, Action Groups.

## Alert Processing Rules

<<TBD>>

## Action Groups

<<TBD>>

## Metric Alerts Settings

The values shown for Aggregation, Operator, Threshold, WindowSize, Frequency and Severity have been derived from field and what we've seen from other customers, we encourage you to adjust these threshold to match your environment.


| Component                                | Metric                                            | Aggregation   | Operator           | Threshold   | WindowSize   | Frequency   | Severity   | <div style="width:240px">References</div>                                                                                                                                                                                                                                                                                                             | Path                                                                                                                                                                                                                                                |
|:-----------------------------------------|:-------------------------------------------------:|:-------------:|:------------------:|:-----------:|:------------:|:-----------:|:----------:|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| microsoft.network/expressroutecircuits   | BgpAvailability                                   | Average       | LessThan           | 90          | PT5M         | PT1M        | 0          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                     | [deploy-ercir_bgpavailability_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-ercir_bgpavailability_alert.bicep)                                 |
| microsoft.network/expressroutecircuits   | ArpAvailability                                   | Average       | LessThan           | 90          | PT5M         | PT1M        | 0          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                     | [deploy-ercir_arpavailability_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-ercir_arpavailability_alert.bicep)                                 |
| microsoft.network/expressroutecircuits   | QosDropBitsInPerSecond                            | Average       | GreaterThan        | 100         | PT5M         | PT1M        | 2          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                     | [deploy-ercir_qosdropsbitsin_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-ercir_qosdropsbitsin_alert.bicep)                                   |
| microsoft.network/expressroutecircuits   | QosDropBitsOutPerSecond                           | Average       | GreaterThan        | 100         | PT5M         | PT1M        | 2          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                     | [deploy-ercir_qosdropsbitsout_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-ercir_qosdropsbitsout_alert.bicep)                                 |
| Microsoft.KeyVault/vaults                | Availability                                      | Average       | LessThan           | 90          | PT5M         | PT1M        | 1          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview) | [deploy-kv_availability_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-kv_availability_alert.bicep)                                             |
| Microsoft.KeyVault/vaults                | SaturationShoebox                                 | Average       | GreaterThan        | 75          | PT5M         | PT1M        | 1          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview) | [deploy-kv_capacity_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-kv_capacity_alert.bicep)                                                     |
| Microsoft.KeyVault/vaults                | ServiceApiLatency                                 | Average       | GreaterThan        | 1000        | PT5M         | PT1M        | 3          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview) | [deploy-kv_latency_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-kv_latency_alert.bicep)                                                       |
| Microsoft.KeyVault/vaults                | ServiceApiResult                                  | Average       | GreaterThan        | dynamic     | PT5M         | PT1M        | 2          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview) | [deploy-kv_requests_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-kv_requests_alert.bicep)                                                     |
| Microsoft.Automation/automationAccounts  | TotalJob                                          | Count         | GreaterThan        | 0           | PT5M         | PT1M        | 2          | [Azure Automation Azure Monitor Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftautomationautomationaccounts)                                                                                                                                                                                     | [deploy-aa_totaljob_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-aa_totaljob_alert.bicep)                                                     |
| Microsoft.Network/azureFirewalls         | FirewallHealth                                    | Average       | LessThan           | 90          | PT5M         | PT1M        | 0          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-afw_firewallhealth_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-afw_firewallhealth_alert.bicep)                                       |
| Microsoft.Network/azureFirewalls         | SNATPortUtilization                               | Average       | GreaterThan        | 80          | PT5M         | PT1M        | 1          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-afw_snatportutilization_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-afw_snatportutilization_alert.bicep)                             |
| microsoft.network/vpngateways            | BgpPeerStatus                                     | Total         | LessThan           | 1           | PT5M         | PT5M        |            | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-vpng_bgppeerstatus_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vpng_bgppeerstatus_alert.bicep)                                       |
| microsoft.network/vpngateways            | TunnelIngressPacketDropTSMismatch                 | Average       | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-vpng_ingresspacketdropmismatch_alert.bicep](https://github.com/Azure/alz-monitor/blob/fdd0ab013ee6f35a53e130384734e20c0a722b54/Observability_L100/Deploy/policyDefinitions/deploy-vpng_ingresspacketdropmismatch_alert.bicep)               |
| microsoft.network/vpngateways            | TunnelEgressPacketDropCount                       | Total         | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-vpng_egresspacketdropcount_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-vpng_egresspacketdropcount_alert.bicep)                       |
| microsoft.network/vpngateways            | TunnelIngressPacketDropCount                      | Total         | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-vpng_ingresspacketdropcount_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-vpng_ingresspacketdropcount_alert.bicep)                     |
| microsoft.network/vpngateways            | TunnelEgressPacketDropTSMismatch                  | Total         | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                               | [deploy-vpng_egresspacketdropmismatch_alert.bicep](https://github.com/Azure/alz-monitor/blob/fdd0ab013ee6f35a53e130384734e20c0a722b54/Observability_L100/Deploy/policyDefinitions/deploy-vpng_egresspacketdropmismatch_alert.bicep)                 |
| microsoft.network/virtualNetworkGateways | ExpressRouteGatewayCpuUtilization                 | Average       | GreaterThan        | 90          | PT5M         | PT1M        | 1          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_expressroutecpuutilization_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vnetg_expressroutecpuutilization_alert.bicep)           |
| microsoft.network/virtualNetworkGateways | BgpPeerStatus                                     | Total         | LessThan           | 1           | PT5M         | PT5M        |            | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_bgppeerstatus_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-vnetg_bgppeerstatus_alert.bicep)                                     |
| microsoft.network/expressroutegateways   | ExpressRouteGatewayCpuUtilization                 | Average       | GreaterThan        | 80          | PT5M         | PT1M        | 1          | [ExpressRoute Monitoring Metrics Alerts for ExpressRoute Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                  | [deploy-vnetg_expressroutecpuutilization_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutecpuutilization_alert.bicep)              |
| Microsoft.Network/privateDnsZones        | VirtualNetworkLinkCapacityUtilization             | Maximum       | GreaterThanEqualTo | 80          | PT1H         | PT1H        | 2          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                     | [deploy-pdnsz_capacityutilization_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pdnsz_capacityutilization_alert.bicep)                         |
| Microsoft.Network/privateDnsZones        | QueryVolume                                       | Total         | GreaterThanOrEqual | 500         | PT1H         | PT1H        | 4          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                     | [deploy-pdnsz_queryvolume_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pdnsz_queryvolume_alert.bicep)                                         |
| Microsoft.Network/privateDnsZones        | RecordSetCapacityUtilization                      | Maximum       | GreaterThanOrEqual | 75          | PT1H         | PT1H        | 2          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                     | [deploy-pdnsz_recordsetcapacity_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pdnsz_recordsetcapacity_alert.bicep)                             |
| Microsoft.Network/privateDnsZones        | VirtualNetworkWithRegistrationCapacityUtilization | Maximum       | GreaterThan        | 90          | PT1H         | PT1H        | 2          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                     | [deploy-pdnsz_registrationcapacityutilization_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pdnsz_registrationcapacityutilization_alert.bicep) |
| Microsoft.Network/publicIPAddresses      | bytesinddos                                       | Maximum       | GreaterThan        | 8000000     | PT5M         | PT5M        | 4          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                                                                               | [deploy-pip_bytesinddosattack_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pip_bytesinddosattack_alert.bicep)                                 |
| Microsoft.Network/publicIPAddresses      | ifunderddosattack                                 | Maximum       | GreaterThan        | 1           | PT5M         | PT5M        | 1          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                                                                               | [deploy-pip_ddosattack_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pip_ddosattack_alert.bicep)                                               |
| Microsoft.Network/publicIPAddresses      | PacketsInDDoS                                     | Total         | GreaterThanEqualTo | 40000       | PT5M         | PT5M        | 4          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                                                                               | [deploy-pip_packetsinddos_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pip_packetsinddos_alert.bicep)                                         |
| Microsoft.Network/publicIPAddresses      | VipAvailability                                   | Average       | LessThan           | 1           | PT5M         | PT5M        | 1          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                                                                               | [deploy-pip_vipavailability_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-pip_vipavailability_alert.bicep)                                     |
| Microsoft.Network/virtualNetworks        | ifunderddosattack                                 | Maximum       | GreaterThanOrEqual | 1           | PT5M         | PT5M        | 1          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworks)                                                                                                                                                                 | [deploy-vnet_ddosattack_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnet_ddosattack_alert.bicep)                                                |
| Microsoft.Network/virtualNetworks        | PingMeshAverageRoundtripMs                        | Average       | GreaterThan        | 300         | PT5M         | PT5M        | 4          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworks)                                                                                                                                                                 | [deploy-vnet_pingavgroundtrip_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vnet_pingavgroundtrip_alert.bicep)                                 |
| Microsoft.Network/virtualNetworkGateways | TunnelAverageBandwidth                            | Average       | LessThan           | 1           | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_tunnelbandwidth_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vnetg_tunnelbandwidth_alert.bicep)                                 |
| Microsoft.Network/virtualNetworkGateways | TunnelEgressBytes                                 | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_tunnelegress_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vnetg_tunnelegress_alert.bicep)                                       |
| Microsoft.Network/virtualNetworkGateways | TunnelIngressBytes                                | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_tunnelingress_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vnetg_tunnelingress_alert.bicep)                                     |
| microsoft.network/vpngateways            | tunnelaveragebandwidth                            | Average       | GreaterThan        | 1000000000  | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways)                                                                                                                                                                     | [deploy-vpng_bandwidthutilization_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vpng_bandwidthutilization_alert.bicep)                         |
| microsoft.network/vpngateways            | tunnelegressbytes                                 | Total         | LessThanOrEqual    | 0           | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways)                                                                                                                                                                     | [deploy-vpng_egress_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vpng_egress_alert.bicep)                                                     |
| microsoft.network/vpngateways            | tunnelingressbytes                                | Total         | LessThanOrEqual    | 0           | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways)                                                                                                                                                                     | [deploy-vpng_ingress_alert.bicep](https://github.com/Azure/alz-monitor/blob/d78aea3853e9839fe87019bc6e9267525bb73102/Observability_L100/Deploy/policyDefinitions/deploy-vpng_ingress_alert.bicep)                                                   |
| Microsoft.Network/virtualNetworkGateways | TunnelIngressPacketDropTSMismatch                 | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vpng_ingresspacketdropmismatch_alert.bicep](https://github.com/Azure/alz-monitor/blob/fdd0ab013ee6f35a53e130384734e20c0a722b54/Observability_L100/Deploy/policyDefinitions/deploy-vpng_ingresspacketdropmismatch_alert.bicep)               |
| Microsoft.Network/virtualNetworkGateways | TunnelEgressPacketDropCount                       | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_egresspacketdropcount_alert.json](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egresspacketdropmismatch_alert.bicep)                      |
| Microsoft.Network/virtualNetworkGateways | TunnelIngressPacketDropCount                      | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_ingresspacketdropcount_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_ingresspacketdropcount_alert.bicep)                      |
| Microsoft.Network/virtualNetworkGateways | TunnelEgressPacketDropTSMismatch                  | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_egresspacketdropmismatch_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egresspacketdropmismatch_alert.bicep)                  |
| Microsoft.Network/virtualNetworkGateways | ExpressRouteGatewayBitsPerSecond                  | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                          | [deploy-vnetg_expressroutebitspersecond_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutebitspersecond_alert.bicep)                |
| microsoft.network/expressroutegateways   | ERGatewayConnectionBitsInPerSecond                | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | [ExpressRoute Monitoring Metrics Alerts - ExpressRoute-Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                    | [deploy-erg_bitsinpersecond_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-erg_bitsinpersecond_alert.bicep)                                        |
| microsoft.network/expressroutegateways   | ERGatewayConnectionBitsOutPerSecond               | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | [ExpressRoute Monitoring Metrics Alerts - ExpressRoute-Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                    | [deploy-erg_bitsoutpersecond_alert.bicep](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-erg_bitsoutpersecond_alert.bicep)                                      |


## Activity Log Alerts

| Component | Metric |<div style="width:300px">Query</div> |Aggregator | Operator | Threshold | WindowSize | Frequency | Dimensions | Mandatory | Documented |<div style="width:240px">References</div>|
|:----------|:------:|:----------:|:----------:|:--------:|:---------:|:----------:|:---------:|:----------:|:---------:|:----------:|:---------------------------------------|
|||||||||||||

## Log Alerts


| Component | Metric |<div style="width:300px">Query</div> | Aggregator | Operator | Threshold | WindowSize | Frequency | Dimensions | Mandatory | Documented |<div style="width:240px">References</div>|
|:----------|:------:|:------|:----------:|:--------:|:---------:|:----------:|:---------:|:----------:|:---------:|:----------:|:---------------------------------------|
| microsoft.network/expressroutecircuits | BgpAvailability         |`AzureMetrics`<br/>`| where MetricName == "BgpAvailability"`<br/> `| summarize by Average, bin(TimeGenerated, 5m), Resource` <br/> `| render timechart` |0       | LessThan    | 90  | PT5M | PT1M |  Peer | No | Y | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries) |
| microsoft.network/expressroutecircuits | ArpAvailability         |`AzureMetrics`<br/>`| where MetricName == "ArpAvailability"`<br/> `| summarize by Average, bin(TimeGenerated, 5m), Resource` <br/> `| render timechart` |Average | LessThan    | 90  | PT5M | PT1M |  Peer | No | Y | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries) |
| microsoft.network/expressroutecircuits | BitsInPerSecond  |`AzureMetrics`<br/> `| where MetricName == "BitsInPerSecond"` <br/> `| summarize by Average, bin(TimeGenerated, 1h), Resource` <br/> `| render timechart` |Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |                                                                                                                                                                                                                                                         |
| microsoft.network/expressroutecircuits | BitsOutPerSecond |```AzureMetrics | where MetricName == "BitsInPerSecond"| summarize by Average, bin(TimeGenerated, 1h), Resource| render timechart``` |Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |
| microsoft.network/expressroutecircuits | QosDropBitsInPerSecond | `AzureMetrics| where MetricName == "QosDropBitsInPerSecond"` <br/> `| summarize by Average, bin(TimeGenerated, 1h), Resource` <br/> `| render timechart` | Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |
| microsoft.network/expressroutecircuits | QosDropBitsOutPerSecond | ```AzureMetrics | where MetricName == "QosDropBitsInPerSecond" | summarize by Average, bin(TimeGenerated, 1h), Resource | render timechart```  | Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |






