# Metric Alerts Details

The following metric alerts have been defined and can deployed within your landing zones via Azure Policy.

The resources, metric alerts and their settings provide you with a starting point to help you address the following monitoring questions:
"What should we monitor in Azure?" and "What alert settings should we use?"  While they are opinionated settings and they are meant to cover the most common Azure Landing Zone components, we encourage you to adjust these settings to suit your monitoring needs based on how you're using Azure.

If you have suggestions for other resources that should be included please open an Issue on this page providing the Azure resource provider and settings you'd like implemented, we can't promise to implement them all but we will look into it. Or if you'd like to contribute directly, follow the steps on how to contribute [here](https://github.com/azure/alz-monitor/docs/wiki/Contributing.md#git-information-on-contributing).

## Metric Alerts Settings

The values shown for Aggregation, Operator, Threshold, WindowSize, Frequency and Severity have been derived from field experience and what customers have implemented themselves; Alerts are based on Microsoft public guidance where available (indicated by a 'Yes' in the Verified column), and on practical application experience where public guidance is not available (indicated by a 'No' in the Verified column). Links to Product Group guidance can be found in the References column and when no guidance is provided we've provided a link to the description of the Metric on learn.microsoft.com.

The Scope column details where we scoped the alerts as described in [Introduction to deploying ALZ-Monitor](./Introduction-to-deploying-ALZ-Monitor.md).  


Only a small number of the resources support metric alert rules scoped at the subscription level and the metric alerts would only apply to resources deployed within the same region. The Support for Multiple Resources column to show which resources support metric alerts being scoped at the subscription level. For a complete list of which resources support metrics alert rules scoped at the subscription level click [here](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-types.md#monitor-multiple-resources).

> **NOTE**: There are hidden columns within the table, to scroll across you need to go to the bottom of the table to scroll and this is a limitation within tables in GitHub. If you have any suggestions to improving this expeirence please do get in touch via a PR or raise an issue, thank you.

| AlertName                                                                                                                                                                                                                                 | Component                                | Metric                                            | Aggregation | Operator           | Threshold  | WindowSize | Frequency | Severity | Scope    | Support for Multiple Resources | Verified | References                                                                                                                                                                                                                                                                                                                                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|---------------------------------------------------|-------------|--------------------|------------|------------|-----------|----------|----------|--------------------------------|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy ExpressRoute Circuits Bgp Availability Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_bgpavailability_alert.bicep)<sup>1</sup>                 | microsoft.network/expressroutecircuits   | BgpAvailability                                   | Average     | LessThan           | 90         | PT5M       | PT1M      | 0        | Resource | No                             | Yes        | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                              |
| [[DINE] Deploy ExpressRoute Circuits Arp Availability Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_arpavailability_alert.bicep)<sup>1</sup>                 | microsoft.network/expressroutecircuits   | ArpAvailability                                   | Average     | LessThan           | 90         | PT5M       | PT1M      | 0        | Resource | No                             | Yes        | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                              |
| [[DINE] Deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_qosdropsbitsin_alert.bicep)                        | microsoft.network/expressroutecircuits   | QosDropBitsInPerSecond                            | Average     | GreaterThan        | 100        | PT5M       | PT1M      | 2        | Resource | No                             | No        | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                              |
| [[DINE] Deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_qosdropsbitsout_alert.bicep)                      | microsoft.network/expressroutecircuits   | QosDropBitsOutPerSecond                           | Average     | GreaterThan        | 100        | PT5M       | PT1M      | 2        | Resource | No                             | No        | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                              |
| [[DINE] Deploy KeyVault Availability Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_availability_alert.bicep)<sup>1</sup>                                        | Microsoft.KeyVault/vaults                | Availability                                      | Average     | LessThan           | 90         | PT5M       | PT1M      | 1        | Resource | Yes                            | Yes        | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                     |
| [[DINE] Deploy KeyVault Capacity Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_capacity_alert.bicep)                                                            | Microsoft.KeyVault/vaults                | SaturationShoebox                                 | Average     | GreaterThan        | 75         | PT5M       | PT1M      | 1        | Resource | Yes                            | Yes        | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                     |
| [[DINE] Deploy KeyVault Latency Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_latency_alert.bicep)                                                              | Microsoft.KeyVault/vaults                | ServiceApiLatency                                 | Average     | GreaterThan        | 1000       | PT5M       | PT1M      | 3        | Resource | Yes                            | Yes        | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                     |
| [[DINE] Deploy KeyVault Requests Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_requests_alert.bicep)                                                            | Microsoft.KeyVault/vaults                | ServiceApiResult                                  | Average     | GreaterThan        | dynamic    | PT5M       | PT1M      | 2        | Resource | Yes                            | Yes        | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                     |
| [[DINE] Deploy Automation Account TotalJob Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-aa_totaljob_alert.bicep)                                                  | Microsoft.Automation/automationAccounts  | TotalJob                                          | Count       | GreaterThan        | 0          | PT5M       | PT1M      | 2        | Resource | No                             | No        | [Azure Automation Azure Monitor Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftautomationautomationaccounts)                                                                                                                                                                                                                                         |
| [[DINE] Deploy AFW FirewallHealth Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-afw_firewallhealth_alert.bicep)                                                    | Microsoft.Network/azureFirewalls         | FirewallHealth                                    | Average     | LessThan           | 90         | PT5M       | PT1M      | 0        | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy AFW SNATPortUtilization Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-afw_snatportutilization_alert.bicep)                                          | Microsoft.Network/azureFirewalls         | SNATPortUtilization                               | Average     | GreaterThan        | 80         | PT5M       | PT1M      | 1        | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy SA Availability Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-sa_availability_alert.bicep)<sup>1</sup>                                              | Microsoft.Storage/storageAccounts        | Availability                                      | Average     | LessThan           | 90         | PT5M       | PT5M      | 1        | Resource | No                             | Y        | [Monitoring Availability](https://docs.microsoft.com/en-us/azure/storage/common/storage-monitoring-diagnosing-troubleshooting?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&tabs=dotnet#monitoring-availability<br>)                                                                                                                                                                                          |
| [[DINE] Deploy VPNG  BGP Peer Status Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_bgppeerstatus_alert.bicep)                                                 | microsoft.network/vpngateways            | BgpPeerStatus                                     | Total       | LessThan           | 1          | PT5M       | PT5M      |          | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy VPNG Ingress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_ingresspacketdropmismatch_alert.bicep)                         | microsoft.network/vpngateways            | TunnelIngressPacketDropTSMismatch                 | Average     | GreaterThan        | dynamic    | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy VPNG Egress Packet Drop Count Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_egresspacketdropcount_alert.bicep)                                 | microsoft.network/vpngateways            | TunnelEgressPacketDropCount                       | Total       | GreaterThan        | dynamic    | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy VPNG Ingress Packet Drop Count Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_ingresspacketdropcount_alert.bicep)                               | microsoft.network/vpngateways            | TunnelIngressPacketDropCount                      | Total       | GreaterThan        | dynamic    | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy VPNG Egress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_egresspacketdropmismatch_alert.bicep)                           | microsoft.network/vpngateways            | TunnelEgressPacketDropTSMismatch                  | Total       | GreaterThan        | dynamic    | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                   |
| [[DINE] Deploy VNetG ExpressRoute CPU Utilization Alert'](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutecpuutilization_alert.bicep)                     | microsoft.network/virtualNetworkGateways | ExpressRouteGatewayCpuUtilization                 | Average     | GreaterThan        | 90         | PT5M       | PT1M      | 1        | Resource | No                             | Yes        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG ExpressRoute CPU Utilization Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutecpuutilization_alert.bicep)                      | microsoft.network/expressroutegateways   | ExpressRouteGatewayCpuUtilization                 | Average     | GreaterThan        | 80         | PT5M       | PT1M      | 1        | Resource | No                             | Yes        | [ExpressRoute Monitoring Metrics Alerts for ExpressRoute Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                                                                      |
| [[DINE] Deploy PDNSZ Capacity Utilization Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_capacityutilization_alert.bicep)                                     | Microsoft.Network/privateDnsZones        | VirtualNetworkLinkCapacityUtilization             | Maximum     | GreaterThanEqualTo | 80         | PT1H       | PT1H      | 2        | Resource | No                             | No        | [Private DNS Alert Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones)                                                                                                                                                                                                                                                            |
| [[DINE] Deploy PDNSZ Query Volume Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_queryvolume_alert.bicep)                                                     | Microsoft.Network/privateDnsZones        | QueryVolume                                       | Total       | GreaterThanOrEqual | 500        | PT1H       | PT1H      | 4        | Resource | No                             | No        | [Private DNS Alert Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones)                                                                                                                                                                                                                                                            |
| [[DINE] Deploy PDNSZ Record Set Capacity Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_recordsetcapacity_alert.bicep)                                        | Microsoft.Network/privateDnsZones        | RecordSetCapacityUtilization                      | Maximum     | GreaterThanOrEqual | 75         | PT1H       | PT1H      | 2        | Resource | No                             | No        | [Private DNS Alert Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones)                                                                                                                                                                                                                                                            |
| [[DINE] Deploy PDNSZ Registration Capacity Utilization Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_registrationcapacityutilization_alert.bicep)            | Microsoft.Network/privateDnsZones        | VirtualNetworkWithRegistrationCapacityUtilization | Maximum     | GreaterThan        | 90         | PT1H       | PT1H      | 2        | Resource | No                             | No        | [Private DNS Alert Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones)                                                                                                                                                                                                                                                            |
| [[DINE] Deploy PIP Bytes in DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_bytesinddosattack_alert.bicep)                                           | Microsoft.Network/publicIPAddresses      | bytesinddos                                       | Maximum     | GreaterThan        | 8000000    | PT5M       | PT5M      | 4        | Resource | No                             | No        | [Monitor Public IP Addresses](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/monitor-public-ip#alerts)<br>[Public IP Addresses Supported Metrics](https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                              |
| [[DINE] Deploy PIP DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_ddosattack_alert.bicep)                                                           | Microsoft.Network/publicIPAddresses      | ifunderddosattack                                 | Maximum     | GreaterThan        | 1          | PT5M       | PT5M      | 1        | Resource | No                             | Yes        | [Monitor Public IP Addresses](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/monitor-public-ip#alerts)<br>[Public IP Addresses Supported Metrics](https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                              |
| [[DINE] Deploy PIP Packets in DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_packetsinddos_alert.bicep)                                             | Microsoft.Network/publicIPAddresses      | PacketsInDDoS                                     | Total       | GreaterThanEqualTo | 40000      | PT5M       | PT5M      | 4        | Resource | No                             | No        | [Monitor Public IP Addresses](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/monitor-public-ip#alerts)<br>[Public IP Addresses Supported Metrics](https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                              |
| [[DINE] Deploy PIP VIP Availability Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_vipavailability_alert.bicep)                                                 | Microsoft.Network/publicIPAddresses      | VipAvailability                                   | Average     | LessThan           | 1          | PT5M       | PT5M      | 1        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                                                                                                                                   |
| [[DINE] Deploy VNet DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnet_ddosattack_alert.bicep)                                    | Microsoft.Network/virtualNetworks        | ifunderddosattack                                 | Maximum     | GreaterThanOrEqual | 1          | PT5M       | PT5M      | 1        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworks)                                                                                                                                                                                                                     |
| [[DINE] Deploy VNetG Tunnel Bandwidth Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_bandwidthutilization_alert.bicep)                                        | Microsoft.Network/virtualNetworkGateways | TunnelAverageBandwidth                            | Average     | LessThan           | 1          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG Tunnel Egress Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egress_alert.bicep)                                                         | Microsoft.Network/virtualNetworkGateways | TunnelEgressBytes                                 | Average     | LessThanOrEqual    | 1          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG Tunnel Ingress Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_ingress_alert.bicep)                                                       | Microsoft.Network/virtualNetworkGateways | TunnelIngressBytes                                | Average     | LessThanOrEqual    | 1          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VPNG Bandwidth Utilization Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_bandwidthutilization_alert.bicep)                                     | microsoft.network/vpngateways            | tunnelaveragebandwidth                            | Average     | GreaterThan        | 1000000000 | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Monitor VPN Gateway](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway)<br>[Monitor VPN Gateway Reference](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway-reference)[<br>Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways) |
| [[DINE] Deploy VPNG Egress Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_egress_alert.bicep)                                                                  | microsoft.network/vpngateways            | tunnelegressbytes                                 | Total       | LessThanOrEqual    | 0          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Monitor VPN Gateway](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway)<br>[Monitor VPN Gateway Reference](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway-reference)[<br>Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways) |
| [[DINE] Deploy VPNG Ingress Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_ingress_alert.bicep)                                                                | microsoft.network/vpngateways            | tunnelingressbytes                                | Total       | LessThanOrEqual    | 0          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Monitor VPN Gateway](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway)<br>[Monitor VPN Gateway Reference](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway-reference)[<br>Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways) |
| [[DINE] Deploy VPNG Ingress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/fdd0ab013ee6f35a53e130384734e20c0a722b54/Observability_L100/Deploy/policyDefinitions/deploy-vpng_ingresspacketdropmismatch_alert.bicep) | Microsoft.Network/virtualNetworkGateways | TunnelIngressPacketDropTSMismatch                 | Average     | GreaterThan        | 100        | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG Egress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egresspacketdropmismatch_alert.bicep)    | Microsoft.Network/virtualNetworkGateways | TunnelEgressPacketDropCount                       | Average     | GreaterThan        | 100        | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG Ingress Packet Drop Count Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_ingresspacketdropcount_alert.bicep)        | Microsoft.Network/virtualNetworkGateways | TunnelIngressPacketDropCount                      | Average     | GreaterThan        | 100        | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG Egress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egresspacketdropmismatch_alert.bicep)    | Microsoft.Network/virtualNetworkGateways | TunnelEgressPacketDropTSMismatch                  | Average     | GreaterThan        | 100        | PT5M       | PT5M      | 3        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy VNetG ExpressRoute Bits Per Second Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutebitspersecond_alert.bicep)  | Microsoft.Network/virtualNetworkGateways | ExpressRouteGatewayBitsPerSecond                  | Average     | LessThanOrEqual    | 1          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                              |
| [[DINE] Deploy ERG ExpressRoute Bits In Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-erg_bitsinpersecond_alert.bicep)                        | microsoft.network/expressroutegateways   | ERGatewayConnectionBitsInPerSecond                | Average     | LessThanOrEqual    | 1          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [ExpressRoute Monitoring Metrics Alerts - ExpressRoute-Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                                                                        |
| [[DINE] Deploy ERG ExpressRoute Bits Out Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-erg_bitsoutpersecond_alert.bicep)                      | microsoft.network/expressroutegateways   | ERGatewayConnectionBitsOutPerSecond               | Average     | LessThanOrEqual    | 1          | PT5M       | PT5M      | 0        | Resource | No                             | No        | [ExpressRoute Monitoring Metrics Alerts - ExpressRoute-Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                                                                        |


<sup>1</sup> See "Why are the availability alert thresholds lower than 100% in this solution when the product group documention recommends 100%?" in the [FAQ](FAQ.md) for more details.

## Activity Log Alerts  

### Activity Log Resource Health

Use the following two sections to quickly know when there's a Service Health issue with an Azure resource, saving you the effort of further troubleshooting and allow you to focus on communicating to your user base and/or use these alerts as part of your business continuity actions (remediations).

| Alert Policy Name                                                                                                                                                                                                | Alert Name                   | targetScope     | Category       | Property.cause                      | Properties.currentHealthStatus | Scope        | Verified | <div style="width:240px">References</div>                                                                                                                                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|-----------------|----------------|-------------------------------------|--------------------------------|--------------|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy Resource Health Unhealthy Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ResourceHealth-UnHealthly-alert.bicep) | ResourceHealthUnhealthyAlert | managementGroup | ResourceHealth | PlatformInitiated,<br>UserInitiated | Degraded,<br>Unavailable       | Subscription | Yes        | [Resource Health](https://learn.microsoft.com/en-us/azure/service-health/resource-health-overview)<br> [Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |



### Service Health Alerts

| Alert Policy Name                                                                                                                                                                                              | Alert Name                      | PolicyScope     | Category      | properties.incidentType | Scope        | Documented | <div style="width:240px">References</div>                                                                                                                                                                                                                         |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|-----------------|---------------|-------------------------|--------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy Service Health Advisory Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Health.bicep)            | ServiceHealthAdvisoryEvent      | managementGroup | ServiceHealth | ActionRequired          | Subscription | Yes          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Service Health Incident Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Incident.bicep)          | ServiceHealthIncident           | managementGroup | ServiceHealth | Incident                | Subscription | Yes          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Service Health Maintenance Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Maintenance.bicep)    | ServiceHealthPlannedMaintenance | managementGroup | ServiceHealth | Maintenance             | Subscription | Yes          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Service Health Security Advisory Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Security.bicep) | ServiceHealthSecurityIncident   | managementGroup | ServiceHealth | Security                | Subscription | Yes          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |


### Activity Log Administrative

The following table lists a number of operational Activity Log alerts to alert your team when certain resources have been deleted.

There isn't any per resource type guidance so what's been provided is some general guidance on alerting on the deletion of specific resources, the list may grow in the future and of course you can create your own following the pattern used for these Activity Log alerts.

| Alert Policy Name                                                                                                                                                                                                 | Alert Name                  | PolicyScope     | category       | operationName                                                       | status    | Scope        | Documented | <div style="width:240px">References</div>                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|-----------------|----------------|---------------------------------------------------------------------|-----------|--------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy Activity Log Azure FireWall Delete Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-AzureFirewall-Del.bicep)       | ActivityAzureFirewallDelete | managementGroup | Administrative | Microsoft.Microsoft.Network/azurefirewalls/delete                   | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Activity Log Key Vault Delete Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-KeyVault-Del.bicep)                 | ActivityKeyVaultDelete      | managementGroup | Administrative | Microsoft.KeyVault/vaults/delete                                    | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Activity Log LA Workspace Delete Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-LAWorkspace-Del.bicep)           | ActivityLAWorkspaceDelete   | managementGroup | Administrative | Microsoft.OperationalInsights/workspaces/delete                     | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Activity Log LA Workspace Regenerate Key Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-LAWorkspace-ReGen.bicep) | ActivityLAWorkspaceRegenKey | managementGroup | Administrative | Microsoft.OperationalInsights/workspaces/regeneratesharedkey/action | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Activity Log NSG Delete Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-NSG-Del.bicep)                            | ActivityNSGDelete           | managementGroup | Administrative | Microsoft.Network/networkSecurityGroups/delete                      | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Activity Log Route Table Update Alert](https://github.com/Azure/alz-monitor/tree/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-RouteTable-Update.bicep)          | ActivityUDRUpdate           | managementGroup | Administrative | Microsoft.Network/routeTables/routes/write                          | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Activity Log VPN Gateway Delete Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-VPNGate-Del.bicep)                | ActivityVPNGatewayDelete    | managementGroup | Administrative | Microsoft.Network/vpnGateways/delete                                | succeeded | Subscription | No          | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |

## VM Insights Log Alerts

Once VM Insights has been enabled in your environment, the following alert rules can be configured for use via the Baseline Alerts framework.

N/A: Not applicable, not used in the query or used as a parameter.

| AlertName                                                                                                                                                                                           | Component                         | Aggregation | Operator    | Threshold | WindowSize | Frequency | ResolveTime | EvaluationPeriods | FailingPeriods | ComputersToInclude | Other Resources                  | Severity | Query                                                                                                                                                                                                                                                                                                                                                                         | Verified | References                                                                                                                                                        |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|-------------|-------------|-----------|------------|-----------|-------------|-------------------|----------------|--------------------|----------------------------------|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy VM Available Memory Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-PercentMemory_alert.bicep)               | Microsoft.Compute/virtualMachines | Average     | LessThan    | 1000      | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | N/A                | N/A                              | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "Memory" and Name == "AvailableMB"\| extend TotalMemory = toreal(todynamic(Tags)["vm.azm.ms/memorySizeMB"]) \| extend AvailableMemoryPercentage = (toreal(Val) / TotalMemory) * 100.0\| summarize AggregatedValue = avg(AvailableMemoryPercentage) by bin(TimeGenerated, 15m), Computer, _ResourceId``` | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM CPU Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-PercentCPU_alert.bicep)                               | Microsoft.Compute/virtualMachines | Average     | GreaterThan | 85        | PT15M      | PT5M      | 0:10:00     | N/A               | 1              | N/A                | N/A                              | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "Processor" and Name == "UtilizationPercentage"\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId```                                                                                                                                                             | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM Data Disk Write Latency Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-dataDiskwriteLatency_alert.bicep) | Microsoft.Compute/virtualMachines | Average     | GreaterThan    | 50        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | parDisksToInclude <br>*          | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "LogicalDisk" and Name == "ReadLatencyMs"\| extend Disk=tostring(todynamic(Tags)["vm.azm.ms/mountId"])\|where Disk !in (\'C:\',\'/\')\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk```                                                                 | N        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM Data Disk Read Latency Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-dataDiskreadLatency_alert.bicep)   | Microsoft.Compute/virtualMachines | Average     | GreaterThan    | 50        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | parDisksToInclude <br>*          | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "LogicalDisk" and Name == "ReadLatencyMs"\| extend Disk=tostring(todynamic(Tags)["vm.azm.ms/mountId"])\|where Disk !in (\'C:\',\'/\')\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk```                                                                 | N        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM OS Disk Write Latency Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-OSDiskwriteLatency_alert.bicep)     | Microsoft.Compute/virtualMachines | Average     | GreaterThan    | 50        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | parDisksToInclude <br>C:<br> /   | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "LogicalDisk" and Name == "WriteLatencyMs"\| extend Disk=tostring(todynamic(Tags)["vm.azm.ms/mountId"])\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk```                                                                                               | N        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM OS Disk Read Latency Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-OSDiskreadLatency_alert.bicep)       | Microsoft.Compute/virtualMachines | Average     | GreaterThan    | 30        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | parDisksToInclude <br>C:<br> /   | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "LogicalDisk" and Name == "ReadLatencyMs"\| extend Disk=tostring(todynamic(Tags)["vm.azm.ms/mountId"])\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk```                                                                                                | N        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM Network Write Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-NetworkOut_alert.bicep)                     | Microsoft.Compute/virtualMachines | Average     | GreaterThan | 10000000  | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | NetworkInterfacetToInclude <br>* | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "Network" and Name == "WriteBytesPerSecond"\| extend NetworkInterface=tostring(todynamic(Tags)["vm.azm.ms/networkDeviceId"])\|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface```                                                               | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM Network Read Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-NetworkIn_alert.bicep)                       | Microsoft.Compute/virtualMachines | Average     | GreaterThan | 10000000  | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | NetworkInterfacetToInclude <br>* | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "Network" and Name == "ReadBytesPerSecond"\| extend NetworkInterface=tostring(todynamic(Tags)["vm.azm.ms/networkDeviceId"])\|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface```                                                                | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM OS Disk Space Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-OSDiskSpace_alert.bicep)                    | Microsoft.Compute/virtualMachines | Average     | LessThan    | 10        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | parDisksToInclude <br>C:<br> /   | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "LogicalDisk" and Name == "FreeSpacePercentage"\| extend Disk=tostring(todynamic(Tags)["vm.azm.ms/mountId"])\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk```                                                                                          | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM Data Disk Space Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-dataDiskSpace_alert.bicep)                | Microsoft.Compute/virtualMachines | Average     | LessThan    | 10        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | *                  | parDisksToInclude <br>*          | 2        | ```InsightsMetrics\| where Origin == "vm.azm.ms"\| where Namespace == "LogicalDisk" and Name == "FreeSpacePercentage"\| extend Disk=tostring(todynamic(Tags)["vm.azm.ms/mountId"])\|where Disk !in (\'C:\',\'/\')\| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk```                                                           | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |
| [[DINE] Deploy VM HeartBeat Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vm-HeartBeat_alert.bicep)                          | Microsoft.Compute/virtualMachines | Average     | GreaterThan | 10        | PT15M      | PT5M      | 0:10:00     | 1                 | 1              | N/A                | N/A                              | 1        | ```Heartbeat\| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId\| extend Duration = datetime_diff('minute',now(),TimeGenerated)\| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId```                                                                                                                             | Y        | [Monitor virtual machines with Azure Monitor: Alerts](https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-virtual-machine-alerts#common-alert-rules) |

## Recovery Vault Alerts

The following policy disables the classic alerts that are available in Azure Backup and enables the Azure Monitor alerts.

Security Alerts and Job Failure alerts are summarized in the "[Using Backup Center](https://learn.microsoft.com/en-us/azure/backup/backup-azure-monitoring-built-in-monitor?tabs=recovery-services-vaults#azure-monitor-alerts-for-azure-backup)" documentation.

| PolicyName                                                                                                                                                                                    | Component                         | Category                                                                                              | Scope    | Support for Multiple Resources | Verified | References                                                                                                                                                                                                                                                                                                            |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------|----------|--------------------------------|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Deploy_RecoveryVault_BackupHealthMonitor_Alert](https://github.com/Azure/alz-monitor/blob/main/src/resources/Microsoft.Authorization/policyDefinitions/deploy-rv_backuphealth_monitor.bicep) | Microsoft.RecoveryServices/Vaults | Microsoft.RecoveryServices/vaults/monitoringSettings.classicAlertSettings.alertsForCriticalOperations | Resource | No                             | Y        | [Azure Monitor Alerts for Azure Backup](https://learn.microsoft.com/en-us/azure/backup/backup-azure-monitoring-built-in-monitor?tabs=recovery-services-vaults#azure-monitor-alerts-for-azure-backup) <br> [Move to Azure Monitor Alerts](https://learn.microsoft.com/en-us/azure/backup/move-to-azure-monitor-alerts) |


